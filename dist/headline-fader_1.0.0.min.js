/* Copyright (c) 2016 Peter Johnson, MIT license.
* v1.0.0 built 2016-9-2 */"use strict";window.headlineFader=function(){var e="hf",n=void 0,t=function(t){n=document.createElement("style");var i=e;n.innerHTML="."+i+"-headline."+i+"-hide{opacity:0;} ."+i+"-headline{opacity:1;transition:opacity "+t.fadeTime+";}",document.head.appendChild(n)},i={headlines:[],wait:7e3,fadeTime:"2s",pauseOnHover:!0,onClick:null,onUpdate:null},r=function(r){var o,a,l,u,s,d,c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],v=!1,f=null,m=function(e){if(!Array.isArray(e))throw new Error("headlines requires an array.");if(e.length<1)throw new Error("headlines needs to contain at least 1 element.");return e.map(function(e){return"string"==typeof e?{html:e}:e})},h=function(e){if(e.stopPropagation(),f){var n=a[f],t=n.href;l.onClick&&l.onClick(e,t)}},p=function(){r.classList.add(e+"-hide")},L=function(){r.classList.remove(e+"-hide")},y=function(){var n=arguments.length<=0||void 0===arguments[0]?1:arguments[0];null===f?f=0:(f+=n,f===a.length?f=0:f===-1&&(f=a.length-1));var t=a[f],i=t.text,o=t.html,l=t.href;if(l){var u=document.createElement("a");u.href=l,u.className=e+"-link",o?u.innerHTML=o:u.textContent=i,r.innerHTML="",r.appendChild(u)}else o?r.innerHTML=o:r.textContent=i},g=function(){var e=arguments.length<=0||void 0===arguments[0]?1:arguments[0];clearTimeout(u),r.style.transition="none",requestAnimationFrame(function(){p(),requestAnimationFrame(function(){y(e),r.style.transition="",requestAnimationFrame(function(){L()})})})},w=function(){g(-1)},E=function(){var e=window.getComputedStyle(r).opacity;if("0"===e)y(),L();else if("1"===e&&v&&(u=setTimeout(p,l.wait),l.onUpdate)){var n=a[f];l.onUpdate(n,f,l.headlines.length)}},T=function(){v=!0,L(),requestAnimationFrame(function(){p()})},H=function(){v=!1,clearTimeout(u),r.classList.remove(e+"-hide")},O=function(){var e=v;return{enter:function(){l.pauseOnHover&&(e=v,H())},leave:function(){l.pauseOnHover&&e&&T()}}}(),C=function(e){var n=v;n&&H(),l.headlines=a=m(e),f=null,n&&T()},b=function(e){if(!(e in i))throw new Error("The option "+e+" does not exist.");return!0},k=function(e){for(var n in e)e.hasOwnProperty(n)&&("headlines"===n?C(e[n]):b(n)&&(l[n]=e[n]))},x=function(){document.hidden?(d=v,H()):d&&T()},A=function(){r.removeEventListener("transitionend",E),r.removeEventListener("click",h),l.pauseOnHover&&(r.removeEventListener("mouseenter",O.enter),r.removeEventListener("mouseleave",O.leave)),document.removeEventListener("visibilitychange",x,!1),r.classList.remove(e+"-headline",e+"-hide"),r.innerHTML=s;for(var n in o)o.hasOwnProperty(n)&&delete o[n];T=null,H=null,g=null,w=null,A=null,k=null};if(!r||!r.nodeType||1!==r.nodeType)throw new Error("Invalid element argument.");return l=Object.assign({},i),k(c),s=r.innerHTML,t(l),r.addEventListener("transitionend",E,!1),r.classList.add(e+"-headline"),r.addEventListener("click",h,!1),l.pauseOnHover&&(r.addEventListener("mouseenter",O.enter,!1),r.addEventListener("mouseleave",O.leave,!1)),document.addEventListener("visibilitychange",x,!1),o={start:T,stop:H,next:function(){return g()},prev:w,get running(){return v},remove:A,changeOptions:function(e){k(e),"fadeTime"in e&&(document.head.removeChild(n),t(l))}}};return Object.defineProperties(r,{prefix:{enumerable:!0,get:function(){return e},set:function(i){if(i){e=i,document.head.removeChild(n),t(opt)}}}}),r}();